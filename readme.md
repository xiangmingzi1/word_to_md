# Word to Markdown Converter

## 项目简介
本项目是一个 Python 工具，可将 Word 文档（.docx）转换为 Markdown 格式，同时支持：
- 解析 Word 文档中的标题、正文和表格
- 识别上标、下标并转换为 LaTeX 格式
- 按 Token 限制拆分文本，适用于大文本处理
- 生成可读性良好的 Markdown 文档
- 用于解析匹配RAG规范库

## 目录结构
```
word_to_md_project/
│── word_to_md/
│   ├── __init__.py          # 初始化模块
│   ├── doc_parser.py        # 解析 Word 文档
│   ├── text_processing.py   # 文本处理，包括 LaTeX 转换和拆分
│   ├── markdown_writer.py   # 生成 Markdown
│   ├── config.py            # 配置参数
│── main.py                  # CLI 入口
│── requirements.txt         # 依赖库
│── README.md                # 项目说明
```

## 安装依赖
本项目依赖 `python-docx` 和 `transformers` 库，安装方式如下：
```sh
pip install -r requirements.txt
```

## 使用方法
使用命令行运行以下命令，将 Word 文档转换为 Markdown：
```sh
python main.py input.docx output.md --max-tokens 1000
```
- `input.docx`：输入的 Word 文件
- `output.md`：输出的 Markdown 文件

## 功能说明
1. **标题解析**：识别 Word 文档中的标题，并在 Markdown 中转换为 `#` 标题格式。
2. **文本解析**：提取正文内容，并转换特殊格式，如 LaTeX 公式。
3. **表格处理**：将 Word 表格转换为 HTML 格式，嵌入 Markdown 文件中。
4. **Token 限制拆分**：针对大文本，按照最大 Token 限制进行拆分，避免超过处理能力。
5. **LaTeX 公式转换**：支持上标 `^` 和下标 `_` 形式转换为 LaTeX 语法，例如：
   - `H₂O` → `H$_{2}$O`
   - `E=mc²` → `E=mc$^{2}$`

## 示例
**输入 Word 文档（input.docx）：**
```
1.2 水文
1.2.1 流域概况
黄河发源于青藏高原巴颜喀拉山北麓的约古宗列盆地，流域面积75.2万km2（不包括内流区）。自河源至内蒙古的托克托（河口镇附近）为上游，托克托至河南的桃花峪（花园口附近）为中游，桃花峪以下至入海口为下游。
古贤坝址位于黄河中游晋、陕峡谷的下段，上距规划的碛口坝址238.4km，下距壶口瀑布和禹门口铁路桥分别为10km和74.8km，控制流域面积489948km2，占三门峡水库控制流域面积的71%。 
1.2.2 气象
古贤坝址以上流域属大陆性季风气候，根据坝址邻近的吉县气象站统计资料（1993年～2020年），多年平均气温10.9℃，极端最高气温为39.7℃（2005年6月22日），极端最低气温为-21.3℃（2002年12月26日）。多年平均降水量509.4mm，7月～9月降水量占59%，多年平均蒸发量1713.7mm（20cm蒸发皿），最大风速23.2m/s。
```

**输出 Markdown 文件（output.md）：**
```md
&&&
# 综合说明
## 水文
### 1.2.1 流域概况
黄河发源于青藏高原巴颜喀拉山北麓的约古宗列盆地，流域面积75.2万km$^{2}$（不包括内流区）。自河源至内蒙古的托克托（河口镇附近）为上游，托克托至河南的桃花峪（花园口附近）为中游，桃花峪以下至入海口为下游。
古贤坝址位于黄河中游晋、陕峡谷的下段，上距规划的碛口坝址238.4km，下距壶口瀑布和禹门口铁路桥分别为10km和74.8km，控制流域面积489948km$^{2}$，占三门峡水库控制流域面积的71%。
&&&

&&&
# 综合说明
## 水文
### 1.2.2 气象
古贤坝址以上流域属大陆性季风气候，根据坝址邻近的吉县气象站统计资料（1993年～2020年），多年平均气温10.9℃，极端最高气温为39.7℃（2005年6月22日），极端最低气温为-21.3℃（2002年12月26日）。多年平均降水量509.4mm，7月～9月降水量占59%，多年平均蒸发量1713.7mm（20cm蒸发皿），最大风速23.2m/s。
&&&
```

## 适用场景
- 将法律法规、技术文档等 Word 文件转换为 Markdown 格式，便于输入RAG进行匹配。
- 处理大文本，分段存储 Markdown 以用于 NLP 任务。
- 规范化数学表达式，适用于 LaTeX 公式解析。

